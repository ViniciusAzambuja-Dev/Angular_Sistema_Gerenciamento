<div class="flex flex-column">
  <div class="flex gap-2">
    <div class="input-container mb-2">
      <p-dropdown
        styleClass="flex"
        [options]="projectsDatas"
        optionLabel="nome"
        optionValue="id"
        [(ngModel)]="selectedProjectId"
        [editable]="true"
        placeholder="Selecione o projeto">
      </p-dropdown>
    </div>
    <div class="button-container">
      <button
        class="custom-button"
        pButton
        pRipple
        icon="bx bx-filter-alt"
        label="Gerar"
        (click)="getReportDatas()"></button>
    </div>
  </div>
  <div *ngIf="reportDatas;">
    <div class="flex general-metrics pl-3">
      <div class="flex-1">
        <span><h2>Nome: {{ reportDatas.detalhes.nome }}</h2></span>
        <div>
          <div class="flex align-items-center row-report">
            <i class='bx bx-calendar'></i>
            <h3>Data de inicio: {{ reportDatas.detalhes.data_inicio }}</h3>
          </div>
          <div class="flex align-items-center row-report">
            <i class='bx bx-calendar'></i>
            <h3>Data de término(Prevista): {{ reportDatas.detalhes.data_fim }}</h3>
          </div>
          <div class="flex align-items-center row-report">
            <i class='bx bxs-user-check'></i>
            <h3>Quantidade de integrantes: {{ reportDatas.detalhes.quantidadeIntegrantes }}</h3>
          </div>
          <div class="flex align-items-center">
            <i class='bx bxs-time-five' ></i>
            <h3>Total de horas lançadas: {{ reportDatas.detalhes.totalHoras }}</h3>
          </div>
        </div>
      </div>
      <div class="flex-1 activity-container ml-3 pl-3">
        <span><h2>Total de atividades: {{ reportDatas.detalhes.totalAtividades }}</h2></span>
        <div>
          <div class="flex align-items-center row-report">
            <i class='bx bxs-circle completed'></i>
            <h3>Concluídas: {{ reportDatas.detalhes.atividadesConcluidas }}</h3>
          </div>
          <div class="flex align-items-center row-report">
            <i class='bx bxs-circle pending'></i>
            <h3>Em andamento: {{ reportDatas.detalhes.atividadesEmAndamento }}</h3>
          </div>
          <div class="flex align-items-center row-report">
            <i class='bx bxs-circle open'></i>
            <h3>Abertas: {{ reportDatas.detalhes.atividadesAbertas }}</h3>
          </div>
          <div class="flex align-items-center">
            <i class='bx bxs-circle paused'></i>
            <h3>Pausadas: {{ reportDatas.detalhes.atividadesPausadas }}</h3>
          </div>
        </div>
      </div>
    </div>
    <div class="mt-5">
      <h2 class="titles pb-1">Tabela de atividades:</h2>
      <p-table
        [value]="reportDatas.atividades"
        [rows]="5"
        [scrollable]="true"
        scrollHeight="300px"
        [tableStyle]="{'min-width': '100%'}"
        [rowHover]="true"
        dataKey="id"
        styleClass="shadow-2"
      >
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="nome">
              <div>
                Nome
              </div>
            </th>

            <th pSortableColumn="descricao">
              <div>
                Descrição
              </div>
            </th>

            <th pSortableColumn="data_inicio">
              <div>
                De
              </div>
            </th>

            <th pSortableColumn="data_fim">
              <div>
                Até
              </div>
            </th>

            <th pSortableColumn="nomeUsuario">
              <div>
                Responsável
              </div>
            </th>

            <th pSortableColumn="status">
              <div>
                Status
              </div>
            </th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-activity>
          <tr>
            <td> [{{ activity?.nomeProjeto }}] {{ activity?.nome }} </td>
            <td> {{ activity?.descricao }} </td>
            <td> {{ activity?.data_inicio }} </td>
            <td> {{ activity?.data_fim }} </td>
            <td> {{ activity?.nomeUsuario }} </td>
            <td> <p-tag [value]="activity.status" [severity]="getSeverityStatus(activity.status)"></p-tag></td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
              <td colspan="8">Nenhuma atividade encontrada</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="mt-5" *ngIf="reportDatas && reportDatas.dadosGraficoBarras.length > 0">
    <h2 class="titles pb-1">Horas por atividades:</h2>
    <div class="w-full">
      <p-chart type="bar" [data]="barChartDatas" [options]="barChartOptions" />
    </div>
  </div>
</div>
